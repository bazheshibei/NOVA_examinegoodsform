webpackJsonp([1],{"1r3O":function(e,t){},K61J:function(e,t){},KH1Y:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("keep-alive",[t("router-view")],1)],1)},staticRenderFns:[]};var o=a("VU/8")({name:"App"},n,!1,function(e){a("K61J")},null,null).exports,s=a("/ocq"),l=a("Dd8w"),r=a.n(l),c=a("NYxO"),u={data:function(){return{deliveryType:{1:"直发",2:"中转",3:"普通"},select:""}},watch:{"$store.state.time":function(){var e=this.examineGoods;e.examine_time=this.$store.state.time,this.$store.commit("assignData",{name:"examineGoods",obj:e})}},computed:r()({},Object(c.c)(["formData","examineGoods","customMap","pageType"]),Object(c.b)(["summary","accountability"])),methods:{blur:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";i?this.formData[e][i][n][a]=parseFloat(t):this.formData[e][a]=parseFloat(t)},uploadLook:function(e){var t=e.is_pic,a=e.name,i=e.url;if(1===t)window.open(i);else{var n=document.createElement("a");n.href=i,n.download=a,n.click()}},uploadRequest:function(e){var t=this.$store.state.file,a=this.examineGoods.examine_goods_id;t[a]||(t[a]={}),t[a][e.file.uid]=e.file,this.$store.commit("assignData",{name:"file",obj:t})},uploadRemove:function(e){var t=this.$store.state,a=t.file,i=t.del_files,n=this.examineGoods.examine_goods_id,o=e.uid,s=e.acce_id;s?i.push(s):(delete a[n][o],this.$store.commit("assignData",{name:"file",obj:a}))},objectSpanMethod2:function(e){var t=e.row,a=(e.column,e.rowIndex,e.columnIndex);if(0===a||1===a)return t.count?{rowspan:t.count,colspan:1}:{rowspan:0,colspan:0}}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comTableBox",staticStyle:{"margin-top":"0"}},[e._m(0),e._v(" "),a("div",{staticClass:"formLine"},[a("div",{staticClass:"formLabel"},[e._v("项目信息：")]),e._v(" "),a("div",{staticClass:"formText"},[e._v("\n      "+e._s(e.examineGoods.item_information)+"\n    ")]),e._v(" "),a("div",{staticClass:"formLabel"},[e._v("客户名称：")]),e._v(" "),a("div",{staticClass:"formText formMiniText"},[e._v("\n      "+e._s(e.customMap.custom_name)+"\n    ")])]),e._v(" "),a("div",{staticClass:"formLine"},[a("div",{staticClass:"formLabel"},[e._v("验货日期：")]),e._v(" "),a("div",{staticClass:"formText"},[e._v("\n      "+e._s(e.examineGoods.examine_time)+"\n    ")]),e._v(" "),a("div",{staticClass:"formLabel"},[e._v("发货方式：")]),e._v(" "),a("div",{staticClass:"formText formMiniText"},[e._v("\n      "+e._s(e.deliveryType[null!==e.examineGoods.deliver_type?e.examineGoods.deliver_type:e.customMap.delivery_type])+"\n    ")]),e._v(" "),e._m(1),e._v(" "),"view"===e.pageType?a("div",{staticClass:"formText formMiniText"},[e._v("\n      "+e._s({1:"合格",0:"不合格"}[e.examineGoods.final_examine_result])+"\n    ")]):a("div",{staticClass:"formText formMiniText"},[a("el-select",{attrs:{size:"mini"},model:{value:e.examineGoods.final_examine_result,callback:function(t){e.$set(e.examineGoods,"final_examine_result",t)},expression:"examineGoods.final_examine_result"}},[a("el-option",{staticClass:"comSelectOptions",attrs:{label:"合格",value:"1"}}),e._v(" "),a("el-option",{staticClass:"comSelectOptions",attrs:{label:"不合格",value:"0"}})],1)],1)]),e._v(" "),a("div",{staticClass:"formLine"},[a("div",{staticClass:"formLabel"},[e._v("不合格原因汇总：")]),e._v(" "),a("div",{staticClass:"formText"},e._l(e.summary,function(t,i){return a("div",{key:"summary_"+i,staticClass:"summaryBox"},[a("p",{staticClass:"summaryTitle"},[e._v("\n          "+e._s(t[0].index+1)+". "+e._s(t[0].store_name)+"不合格情况：\n        ")]),e._v(" "),e._l(t,function(i,n){return a("p",{key:"summary_item_"+n,staticClass:"summaryText"},[e._v("\n          ·\n          "),e._v(" "),i.reason_type?a("span",[e._v(e._s(i.typeText)+" -> ")]):a("span",[e._v("[请选择"),a("span",{staticClass:"red"},[e._v("原因类型")]),e._v("] ->")]),e._v(" "),i.reason_desc?a("span",[e._v(e._s(i.descText)+" -> ")]):a("span",[e._v("[请选择"),a("span",{staticClass:"red"},[e._v("原因描述")]),e._v("] -> ")]),e._v(" "),i.ratio&&100===i.resultNumCount?a("span",[e._v(e._s(i.ratio)+" -> ")]):100!==i.resultNumCount?a("span",[e._v(" [请填写"),a("span",{staticClass:"red"},[e._v("正確的比例")]),e._v("] ->")]):a("span",[e._v("[请填写"),a("span",{staticClass:"red"},[e._v("比例")]),e._v("] ->")]),e._v(" "),i.handle_mode?a("span",[e._v(e._s(i.handle_mode)+" -> ")]):a("span",[e._v("[请选择"),a("span",{staticClass:"red"},[e._v("处理方式")]),e._v("] ->")]),e._v(" "),i.outInTextArr&&i.outInTextArr.length?a("span",[e._v("\n            "+e._s(i.outInTextArr.join("、"))+"负责\n            "),i.detail_explain?a("span",[e._v("("+e._s(i.detail_explain)+")")]):e._e()]):a("span",[e._v("[请选择"),a("span",{staticClass:"red"},[e._v("责任归属")]),e._v("]")]),e._v(" "),n===t.length-1?a("span",[e._v("。")]):a("span",[e._v("；")])])})],2)}))]),e._v(" "),a("div",{staticClass:"formLine"},[e._m(2),e._v(" "),a("div",{staticClass:"formText"},[a("el-table",{attrs:{data:e.formData,border:"","span-method":e.objectSpanMethod2}},[a("el-table-column",{attrs:{prop:"type",label:"类型",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型占比（%）",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType?a("span",[e._v(e._s(t.row.typeNum))]):a("el-input",{staticClass:"comInput",class:100===e.accountability.total.type?"":"comInputFalse",attrs:{size:"mini"},on:{blur:function(a){e.blur(t.row.index,t.row.typeNum,"typeNum")}},model:{value:t.row.typeNum,callback:function(a){e.$set(t.row,"typeNum",a)},expression:"scope.row.typeNum"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"job",label:"岗位名称",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"岗位占比（%）",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType?a("span",[e._v(e._s(t.row.jobNum)+"  ")]):a("el-input",{staticClass:"comInput",class:100===e.accountability.total.job[t.row.type]?"":"comInputFalse",attrs:{size:"mini"},on:{blur:function(a){e.blur(t.row.index,t.row.jobNum,"jobNum")}},model:{value:t.row.jobNum,callback:function(a){e.$set(t.row,"jobNum",a)},expression:"scope.row.jobNum"}}),e._v(" "),a("p",{staticClass:"showNum"},[e._v("("+e._s(e.accountability.jobNum[t.row.index])+"%)")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"人员占比（%）"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"tableCell"},e._l(t.row.list,function(i,n){return a("div",{key:"name_input_"+n,staticClass:"tablePeople"},[a("span",[e._v(e._s(i.name)+"占比:")]),e._v(" "),"view"===e.pageType?a("span",[e._v(e._s(i.num)+"  ")]):a("el-input",{staticClass:"comInput",class:100===e.accountability.total.peoples[t.row.index]?"":"comInputFalse",attrs:{size:"mini"},on:{blur:function(a){e.blur(t.row.index,i.num,"num","list",n)}},model:{value:i.num,callback:function(t){e.$set(i,"num",t)},expression:"item.num"}}),e._v(" "),e.accountability.peopleNum[t.row.index]?a("p",{staticClass:"showNum",staticStyle:{"text-align":"left","margin-right":"20px"}},[e._v("\n                  ("+e._s(e.accountability.peopleNum[t.row.index][n])+"%)\n                ")]):e._e()],1)}))]}}])})],1)],1)]),e._v(" "),a("div",{staticClass:"formLine"},[a("div",{staticClass:"formLabel"},[e._v("综合说明：")]),e._v(" "),a("div",{staticClass:"formText"},["view"===e.pageType?a("span",[e._v(e._s(e.examineGoods.final_explain))]):a("el-input",{attrs:{size:"mini"},model:{value:e.examineGoods.final_explain,callback:function(t){e.$set(e.examineGoods,"final_explain",t)},expression:"examineGoods.final_explain"}})],1)]),e._v(" "),a("div",{staticClass:"formLine"},[a("div",{staticClass:"formLabel"},[e._v("相关附件：")]),e._v(" "),a("div",{staticClass:"formText"},["view"!==e.pageType?a("el-upload",{staticClass:"asd",attrs:{action:"#",multiple:"","file-list":e.examineGoods.fileList,"on-preview":e.uploadLook,"http-request":e.uploadRequest,"before-remove":e.uploadRemove}},[a("el-button",{attrs:{type:"primary",size:"mini",plain:""}},[e._v(" + 上传附件")])],1):a("el-upload",{staticClass:"asd",attrs:{action:"#",multiple:"","file-list":e.examineGoods.fileList,disabled:"","on-preview":e.uploadLook}})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"comTableTitle"},[t("span",[this._v("录入验货报告")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"formLabel"},[t("span",{staticClass:"red"},[this._v("*")]),this._v("综合验货结果：")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"formLabel"},[t("span",{staticClass:"red"},[this._v("*")]),this._v("责任划分：")])}]};var d=a("VU/8")(u,m,!1,function(e){a("KH1Y"),a("QMsj")},"data-v-04bf508b",null).exports,_=a("bOdI"),p=a.n(_),v={data:function(){return{id:""}},created:function(){},computed:r()({},Object(c.c)(["tableData","arrResult","arrResultType","arrResultDetail","arrOut","arrIn","arrHandlingType","storehouse","tableArray","tableActive","pageType"]),Object(c.b)(["tableList"])),methods:{blurName:function(e){var t=e.store_name,a=e.index,i="";this.tableData[a+"."+t].map(function(e,t){0===t?i=e.examine_name:e.examine_name=i})},blurRatio:function(e,t,a){var i=e.store_name,n=e.index,o=e.key;this.tableData[n+"."+i][o].ratio=parseFloat(a)},uploadLook:function(e){var t=e.is_pic,a=e.name,i=e.url;if(1===t)window.open(i);else{var n=document.createElement("a");n.href=i,n.download=a,n.click()}},uploadRequest:function(e){var t=this.$store.state.file,a=this.id;t[a]||(t[a]={}),t[a][e.file.uid]=e.file,this.$store.commit("assignData",{name:"file",obj:t})},uploadRemove:function(e){var t=this.$store.state,a=t.file,i=t.del_files,n=this.id,o=e.uid,s=e.acce_id;s?i.push(s):(delete a[n][o],this.$store.commit("assignData",{name:"file",obj:a}))},changeTime:function(e){var t=e.index,a=e.store_name,i=e.examine_time,n=e.custom_store_id,o=!0,s=this.tableData;for(var l in s){var r=s[l][0];r.index!==t&&r.examine_time===i&&r.custom_store_id===n&&(this.$message({message:a+" 在 "+i+" 已有验货",type:"warning"}),o=!1)}var c="";this.tableData[t+"."+a].map(function(e,t){o?0===t?c=e.examine_time:e.examine_time=c:e.examine_time=""}),this.$store.commit("changeTime")},deleteData:function(e){var t=e.index,a=e.store_name,i=void 0===a?"新增仓库":a;this.$store.commit("deleteData",{name:"tableData",key:t+"."+i})},addData:function(){var e=this.tableData,t={},a=0;for(var i in e){var n=a+"."+i.split(".")[1],o=e[i];t[n]=o,a++}for(var s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),l=[],r=0;r<32;r++)l[r]=s[0|16*Math.random()];t[a+".新增仓库"]=[{isLocal:!0,accountability:{in:[],out:[]},create_time:"",creator:"",creator_id:"",custom_store_id:"",detail_explain:"",dispatch_order_id:"",examine_detail_duty_id:"",examine_detail_id:l.join(""),examine_goods_id:"",examine_name:"",examine_result:"",examine_time:"",file:{},fileList:[],handle_mode:"",in_post_id:"",index:a,is_delete:"",key:0,outInTextArr:[],out_code:"",ratio:0,reason_desc:"",reason_type:"",remark:"",resultNumCount:0,store_name:void 0,update_time:"",updator:"",updator_id:""}],this.$store.commit("assignData",{name:"tableData",obj:t})},eventChange:function(e,t,a){var i=this.tableData,n=e.store_name,o=e.index,s=e.key;if("ratio"===t&&(i[o+"."+n][s].ratio=parseFloat(a)),"handle_mode"===t){var l=e.store_name,r=e.index,c="";this.tableData[r+"."+l].map(function(e,t){0===t?c=e.handle_mode:e.handle_mode=c})}if("store_name"===t){var u=this.storehouse[a],m={},d="";for(var _ in i){if(_.split(".")[0]===String(o)){m=i[_],d=_;break}}m[s].store_name=a,m[s].is_delete="1",m[s].custom_store_id=u,this.$store.commit("deleteData",{name:"tableData",key:d,type:!0}),this.$store.commit("assignData",{name:"tableData",obj:p()({},o+"."+a,m)})}else"reason_type"===t&&(i[o+"."+n][s].reason_desc=""),i[o+"."+n][s][t]=a,this.$store.commit("assignData",{name:"tableData",obj:i}),"examine_result"===t&&"0"===a&&this.$store.commit("changeCheckbox")},eventCheckbox:function(e){this.$store.commit("changeCheckbox")},objectSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex,e.columnIndex),i=this.tableData;if(a<5||a>10){if(t.key)return{rowspan:0,colspan:0};for(var n=t.store_name,o=void 0===n?"新增仓库":n,s=t.index,l=0,r=0;r<i[s+"."+o].length;r++){var c=i[s+"."+o][r];if("0"!==c.is_delete&&l++,0===r&&"1"===c.examine_result)break}return{rowspan:l,colspan:1}}},activeAdd:function(e){var t=e.store_name,a={accountability:{in:[],out:[]}},i=e.index+"."+t;for(var n in e)"accountability"===n?(e[n].in.forEach(function(e){a.accountability.in.push(e)}),e[n].out.forEach(function(e){a.accountability.out.push(e)})):a[n]=e[n];a.examine_detail_duty_id="",this.$store.commit("pushData",{name:"tableData",key:i,val:a})},activeDelete:function(e){var t=e.store_name,a=e.index,i=e.key;this.$store.commit("spliceData",{name:"tableData",key:a+"."+t,index:i})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comTableBox"},[a("div",{staticClass:"comTableTitle"},[a("span",[e._v("分仓验货明细")]),e._v(" "),a("span",[e._v("    ")]),e._v(" "),"add"===e.pageType||"update"===e.pageType?a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.addData}},[e._v("增加验货明细")]):e._e()],1),e._v(" "),a("el-table",{attrs:{data:e.tableList,border:"","header-cell-style":{background:"none"},"span-method":e.objectSpanMethod}},[a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType?a("div",{staticClass:"comCell"},[a("span",[e._v("--")])]):t.row.dispatch_order_id?a("div",{staticClass:"comCell"},[a("span",[e._v("--")])]):a("div",{staticClass:"comCell"},[a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){e.deleteData(t.row)}}},[e._v("删除")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("仓库\n      ")]}},{key:"default",fn:function(t){return["view"===e.pageType?a("div",{staticClass:"comCell"},[a("span",[e._v(e._s(t.row.store_name))])]):t.row.dispatch_order_id?a("div",{staticClass:"comCell"},[a("span",[e._v(e._s(t.row.store_name))])]):a("div",{staticClass:"comCell"},[a("el-select",{attrs:{size:"mini"},on:{change:function(a){e.eventChange(t.row,"store_name",a)}},model:{value:t.row.store_name,callback:function(a){e.$set(t.row,"store_name",a)},expression:"scope.row.store_name"}},e._l(e.storehouse,function(e,t){return a("el-option",{key:"store_name_"+t,staticClass:"comSelectOptions",attrs:{label:t,value:t}})}))],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"160"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("验货日期\n      ")]}},{key:"default",fn:function(t){return["view"===e.pageType?a("div",{staticClass:"comCell"},[e._v("\n          "+e._s(t.row.examine_time)+"\n        ")]):t.row.custom_store_id?a("div",{staticClass:"comCell"},[a("el-date-picker",{staticClass:"comDatePicker",attrs:{type:"date",size:"mini",placeholder:"请选择日期",editable:"","value-format":"yyyy-MM-dd"},on:{change:function(a){e.changeTime(t.row)}},model:{value:t.row.examine_time,callback:function(a){e.$set(t.row,"examine_time",a)},expression:"scope.row.examine_time"}})],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("验货人\n      ")]}},{key:"default",fn:function(t){return["view"===e.pageType?a("div",{staticClass:"comCell"},[e._v("\n          "+e._s(t.row.examine_name)+"\n        ")]):t.row.custom_store_id?a("div",{staticClass:"comCell"},[a("el-input",{attrs:{size:"mini",placeholder:"请输入验货人"},on:{blur:function(a){e.blurName(t.row)}},model:{value:t.row.examine_name,callback:function(a){e.$set(t.row,"examine_name",a)},expression:"scope.row.examine_name"}})],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("验货结果\n      ")]}},{key:"default",fn:function(t){return["view"===e.pageType?a("div",{staticClass:"comCell"},[e._v("\n          "+e._s({0:"不合格",1:"合格"}[t.row.examine_result])+"\n        ")]):t.row.custom_store_id?a("div",{staticClass:"comCell"},[a("el-select",{attrs:{size:"mini"},on:{change:function(a){e.eventChange(t.row,"examine_result",a)}},model:{value:t.row.examine_result,callback:function(a){e.$set(t.row,"examine_result",a)},expression:"scope.row.examine_result"}},e._l(e.arrResult,function(e,t){return a("el-option",{key:"examine_result_"+t,staticClass:"comSelectOptions",attrs:{label:e,value:t}})}))],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"不合格原因",align:"center"}},[a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("原因类型\n        ")]}},{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[e._v("\n            "+e._s(e.arrResultType[t.row.reason_type].label)+"\n          ")]):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("el-select",{attrs:{size:"mini"},on:{change:function(a){e.eventChange(t.row,"reason_type",a)}},model:{value:t.row.reason_type,callback:function(a){e.$set(t.row,"reason_type",a)},expression:"scope.row.reason_type"}},e._l(e.arrResultType,function(e){return a("el-option",{key:e.value,staticClass:"comSelectOptions",attrs:{label:e.label,value:e.value}})}))],1):a("div",{staticClass:"comCell"},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("原因描述\n        ")]}},{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},e._l(e.arrResultType[t.row.reason_type].arr,function(i,n){return a("span",{directives:[{name:"show",rawName:"v-show",value:i.value===t.row.reason_desc,expression:"viewItem.value === scope.row.reason_desc"}],key:"view_"+n},[e._v("\n              "+e._s(i.label)+"\n            ")])})):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("el-select",{attrs:{size:"mini"},on:{change:function(a){e.eventChange(t.row,"reason_desc",a)}},model:{value:t.row.reason_desc,callback:function(a){e.$set(t.row,"reason_desc",a)},expression:"scope.row.reason_desc"}},e._l(e.arrResultType[t.row.reason_type]?e.arrResultType[t.row.reason_type].arr:[],function(e){return a("el-option",{key:e.value,staticClass:"comSelectOptions",attrs:{label:e.label,value:e.value}})}))],1):a("div",{staticClass:"comCell"},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"120"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("比例（%）\n        ")]}},{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[e._v("\n            "+e._s(t.row.ratio)+"\n          ")]):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("el-input",{staticClass:"comSelectInput",attrs:{size:"mini",placeholder:"请输入比例"},on:{change:function(a){e.eventChange(t.row,"ratio",a)},blur:function(a){e.blurRatio(t.row,"ratio",t.row.ratio)}},model:{value:t.row.ratio,callback:function(a){e.$set(t.row,"ratio",a)},expression:"scope.row.ratio"}})],1):a("div",{staticClass:"comCell"},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"400"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("责任归属\n        ")]}},{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("div",{staticClass:"comCheckboxBox"},[a("span",{staticClass:"comCheckboxLabel"},[e._v("内部：")]),e._v(" "),a("el-checkbox-group",{attrs:{disabled:""},model:{value:t.row.accountability.in,callback:function(a){e.$set(t.row.accountability,"in",a)},expression:"scope.row.accountability.in"}},e._l(e.arrIn,function(t){return a("el-checkbox",{key:"out_"+t.label,attrs:{label:t.label}},[e._v(e._s(t.text))])}))],1),e._v(" "),a("div",{staticClass:"comCheckboxBox"},[a("span",{staticClass:"comCheckboxLabel"},[e._v("外部：")]),e._v(" "),a("el-checkbox-group",{attrs:{disabled:""},model:{value:t.row.accountability.out,callback:function(a){e.$set(t.row.accountability,"out",a)},expression:"scope.row.accountability.out"}},e._l(e.arrOut,function(t){return a("el-checkbox",{key:"out_"+t.label,attrs:{label:t.label}},[e._v(e._s(t.text))])}))],1)]):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("div",{staticClass:"comCheckboxBox"},[a("span",{staticClass:"comCheckboxLabel"},[e._v("内部：")]),e._v(" "),a("el-checkbox-group",{on:{change:e.eventCheckbox},model:{value:t.row.accountability.in,callback:function(a){e.$set(t.row.accountability,"in",a)},expression:"scope.row.accountability.in"}},e._l(e.arrIn,function(t){return a("el-checkbox",{key:"out_"+t.label,attrs:{label:t.label}},[e._v(e._s(t.text))])}))],1),e._v(" "),a("div",{staticClass:"comCheckboxBox"},[a("span",{staticClass:"comCheckboxLabel"},[e._v("外部：")]),e._v(" "),a("el-checkbox-group",{on:{change:e.eventCheckbox},model:{value:t.row.accountability.out,callback:function(a){e.$set(t.row.accountability,"out",a)},expression:"scope.row.accountability.out"}},e._l(e.arrOut,function(t){return a("el-checkbox",{key:"out_"+t.label,attrs:{label:t.label}},[e._v(e._s(t.text))])}))],1)]):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"归属说明",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[e._v("\n            "+e._s(t.row.detail_explain)+"\n          ")]):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("el-input",{staticClass:"comSelectInputLeft",attrs:{size:"mini",placeholder:"请输入归属说明"},on:{change:function(a){e.eventChange(t.row,"detail_explain",a)}},model:{value:t.row.detail_explain,callback:function(a){e.$set(t.row,"detail_explain",a)},expression:"scope.row.detail_explain"}})],1):a("div",{staticClass:"comCell"},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[e._v("--")]):"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[t.row.key?a("i",{staticClass:"el-icon-remove-outline tableIcon",on:{click:function(a){e.activeDelete(t.row)}}}):a("i",{staticClass:"el-icon-circle-plus-outline tableIcon iconPlus",on:{click:function(a){e.activeAdd(t.row)}}})]):a("div",{staticClass:"comCell"},[e._v("--")])]}}])})],1),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("处理方式\n      ")]}},{key:"default",fn:function(t){return["view"===e.pageType&&t.row.custom_store_id&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[e._v("\n          "+e._s(t.row.handle_mode)+"\n        ")]):t.row.custom_store_id&&"0"===t.row.examine_result?a("div",{staticClass:"comCell"},[a("el-select",{attrs:{size:"mini"},on:{change:function(a){e.eventChange(t.row,"handle_mode",a)}},model:{value:t.row.handle_mode,callback:function(a){e.$set(t.row,"handle_mode",a)},expression:"scope.row.handle_mode"}},e._l(e.arrHandlingType,function(e){return a("el-option",{key:e.label,staticClass:"comSelectOptions",attrs:{label:e.text,value:e.label}})}))],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"备注",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["view"===e.pageType&&t.row.custom_store_id?a("div",{staticClass:"comCell"},[e._v("\n          "+e._s(t.row.remark)+"\n        ")]):t.row.custom_store_id?a("div",{staticClass:"comCell"},[a("el-input",{staticClass:"comSelectInputLeft",attrs:{size:"mini",placeholder:"请输入备注"},on:{change:function(a){e.eventChange(t.row,"remark",a)}},model:{value:t.row.remark,callback:function(a){e.$set(t.row,"remark",a)},expression:"scope.row.remark"}})],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"400"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"red"},[e._v("*")]),e._v("验货报告\n      ")]}},{key:"default",fn:function(t){return[t.row.custom_store_id?a("div",{staticClass:"comCell"},["view"!==e.pageType?a("el-upload",{staticClass:"asd",attrs:{action:"#",multiple:"","file-list":t.row.fileList,"on-preview":e.uploadLook,"http-request":e.uploadRequest,"before-remove":e.uploadRemove}},[a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(a){e.id=t.row.examine_detail_id}}},[e._v("上传验货报告")])],1):a("el-upload",{staticClass:"asd",attrs:{action:"#",multiple:"","file-list":t.row.fileList,disabled:"","on-preview":e.uploadLook}})],1):a("div",{staticClass:"comCell",staticStyle:{"text-align":"center"}},[e._v("--")])]}}])})],1)],1)},staticRenderFns:[]};var h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comTableBox",staticStyle:{"margin-top":"0"}},[e._m(0),e._v(" "),a("div",{staticClass:"formLine"},[e._m(1),e._v(" "),a("div",{staticClass:"formText"},[a("el-input",{staticClass:"input_reason",attrs:{size:"mini"},on:{blur:function(t){e.blur("modify_reason")}},model:{value:e.modify_reason,callback:function(t){e.modify_reason=t},expression:"modify_reason"}})],1)]),e._v(" "),a("div",{staticClass:"formLine"},[e._m(2),e._v(" "),a("div",{staticClass:"formText"},[a("el-input",{staticClass:"input_content",attrs:{size:"mini",type:"textarea"},on:{blur:function(t){e.blur("modify_content")}},model:{value:e.modify_content,callback:function(t){e.modify_content=t},expression:"modify_content"}})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"comTableTitle"},[t("span",[this._v("变更说明")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"formLabel"},[t("span",{staticClass:"red"},[this._v("*")]),this._v("变更原因：")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"formLabel"},[t("span",{staticClass:"red"},[this._v("*")]),this._v("变更内容：")])}]};var b={components:{ComForm:d,ComTable:a("VU/8")(v,f,!1,function(e){a("1r3O"),a("T00w")},null,null).exports,ComChange:a("VU/8")({data:function(){return{modify_reason:"",modify_content:""}},methods:{blur:function(e){var t=this[e];this.$store.commit("saveData",{name:e,obj:t})}}},h,!1,function(e){a("bJYQ")},"data-v-31124364",null).exports},data:function(){return{scrollTop:0}},created:function(){var e=JSON.parse(localStorage.getItem("NOVA_examineGoods"))||{},t=e.pageType,a=void 0===t?"":t,i=e.item_id,n=void 0===i?"40289281711abb1a01711b25c4810000":i;this.$store.commit("saveData",{name:"pageType",obj:a}),this.$store.dispatch("A_showAddView",{item_id:n}),dg.removeBtn("cancel"),dg.removeBtn("saveAndAdd"),dg.removeBtn("saveAndClose"),dg.removeBtn("saveNoClose")},computed:r()({},Object(c.c)(["pageType","modify_reason","modify_content"])),methods:{submit:function(e){this.$store.dispatch("A_addExamineGoods",{submitType:e})},pageScroll:function(e){var t=e.target.scrollTop,a=this.scrollTop;Math.abs(t-a)<300?(this.scrollTop=e.target.scrollTop,this.$refs.page.scrollTop=t):this.$refs.page.scrollTop=a},arrIncludes:function(e,t){for(var a=!1,i=0;i<t.length;i++)t[i]===e&&(a=!0);return a}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"page",staticClass:"pageBox",on:{scroll:e.pageScroll}},["modify"===e.pageType?a("com-change"):e._e(),e._v(" "),a("com-form"),e._v(" "),a("com-table"),e._v(" "),a("div",{staticClass:"bottomBox"},["add"===e.pageType||"update"===e.pageType?a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(t){e.submit(0)}}},[e._v("\n      暂存草稿\n    ")]):e._e(),e._v(" "),"view"!==e.pageType?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){e.submit(1)}}},[e._v("\n      "+e._s("modify"===e.pageType?"确认变更":"确认完成")+"\n    ")]):e._e()],1)],1)},staticRenderFns:[]};var y=a("VU/8")(b,x,!1,function(e){a("XGC8"),a("Reu2")},"data-v-4e38b308",null).exports;i.default.use(s.a);var C=new s.a({routes:[{path:"/center",component:y,name:"信息中心"},{path:"/",component:y,name:""}]}),w=a("mvHQ"),g=a.n(w),k=a("woOf"),T=a.n(k),L=a("mtWM"),D=a.n(L),j=a("mw3O"),N=a.n(j),$=a("zL8q"),E=a.n($);D.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",D.a.interceptors.request.use(function(e){return e}),D.a.interceptors.request.use(function(e){if(e.url.indexOf("addExamineGoods")>-1){var t=new FormData;for(var a in e.headers={"Content-Type":"multipart/form-data"},e.data){var i=e.data[a];if("file"===a)for(var n in i){var o=i[n];for(var s in o)t.append(n,o[s])}else t.append(a,i)}return e.data=t,e}return e.data=N.a.stringify(e.data),e});var S=function(e){var t=void 0,a=e.path,i=void 0===a?"":a,n=e.path2,o=void 0===n?"":n,s=e.obj,l=void 0===s?{}:s,r=e.suc,c=void 0===r?function(e){}:r,u=e.err,m=void 0===u?function(e){}:u,d=e.method,_=void 0===d?"post":d,p=e.loading,v=void 0===p?"":p,f=l,h=i+o;if("get"===_){var b=[];for(var x in f)b.push(x+"="+f[x]);h+=b.length?h.indexOf("?")>-1?"&"+b.join("&"):"?"+b.join("&"):""}v&&(t=$.Loading.service({text:v})),D()({method:_,url:h,data:f}).then(function(e){c(e.data.data)}).catch(function(e){m(e),v&&t.close()})},F=window.location.origin+"/nova/",G={"页面数据":"examineGoodsShowAction.ndo?action=showAddView","保存":"examineGoodsSaveAction.ndo?action=addExamineGoods","变更":"examineGoodsModifySaveAction.ndo?action=addExamineGoodsModify","查看变更明细":"examineGoodsModifyShowAction.ndo?action=showViewModify"},I=function(e){e.path=F+G[e.name],S(e)},O=a("+6Bu"),R=a.n(O),A=a("fZjL"),M=a.n(A),z={tableList:function(e){var t=e.tableData,a=[],i={};for(var n in t)for(var o=0;o<t[n].length;o++){var s=t[n][o];if("0"!==s.is_delete){var l=n.split(".")[0];if(i[l]||(i[l]=[]),s.key=o,i[l].push(s),0===o&&"1"===s.examine_result)break}}for(var r in i)a=a.concat(i[r]);return a},summary:function(e){var t=e.tableData,a=e.arrOut,i=e.arrIn,n=e.arrResult,o=e.arrResultType,s={},l=function(e){var l=[],r=0;t[e].forEach(function(e){if("不合格"===n[e.examine_result]){var t=[];if(e.accountability.out.forEach(function(e){a[e]&&t.push(a[e].text)}),e.accountability.in.forEach(function(e){i[e]&&t.push(i[e].text)}),e.outInTextArr=t,r+=parseFloat(e.ratio||0),l.push(e),e.typeText=e.reason_type?o[e.reason_type].label:"",e.reason_type)for(var s=0;s<o[e.reason_type].arr.length;s++){var c=o[e.reason_type].arr[s],u=c.label;if(c.value===e.reason_desc){e.descText=u;break}}else e.descText=""}}),l.forEach(function(e){e.resultNumCount=parseInt(r)}),l.length&&(s[e]=l)};for(var r in t)l(r);return s},accountability:function(e){var t={total:{type:0,job:{},peoples:{}},jobNum:{},peopleNum:{}},a=0,i=0,n=0,o=0;return e.formData.forEach(function(e,s,l){var r=0;if("内部"===e.type?(a=e.typeNum?e.typeNum:a,r=parseFloat(a)*parseFloat(e.jobNum||0)/100,t.jobNum[e.index]=parseFloat(r.toFixed(2)),n+=parseFloat(e.jobNum||0)):"外部"===e.type&&(i=e.typeNum?e.typeNum:i,r=parseFloat(i)*parseFloat(e.jobNum||0)/100,t.jobNum[e.index]=parseFloat(r.toFixed(2)),o+=parseFloat(e.jobNum||0)),M()(e.list).length){var c={},u=0;for(var m in e.list){var d=e.list[m];c[d.name]=parseFloat((parseFloat(d.num||0)*r/100).toFixed(2)),u+=parseFloat(d.num||0)}t.peopleNum[e.index]=c,t.total.peoples[e.index]=parseFloat(u.toFixed(2))}}),t.total.type=parseFloat((parseFloat(a)+parseFloat(i)).toFixed(2)),t.total.job["内部"]=parseFloat(n.toFixed(2)),t.total.job["外部"]=parseFloat(o.toFixed(2)),t},changeTime:function(e){var t=e.tableData,a=[];for(var i in t)if(t[i][0]&&t[i][0].examine_time){var n=new Date(t[i][0].examine_time).getTime();n&&a.push(n)}if(a.sort(),a.length){var o=new Date(a[0]),s=o.getFullYear(),l=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,r=o.getDate()<10?"0"+o.getDate():o.getDate();e.time=s+"-"+l+"-"+r}else e.time=""},changeCheckbox:function(e){var t=[],a=e.arrResult,i=e.formData,n=e.peopleList,o={"内部":{},"外部":{}},s=0,l=0,r={};i.forEach(function(e){e.typeNum&&"内部"===e.type&&(s=e.typeNum),e.typeNum&&"外部"===e.type&&(l=e.typeNum),r[e.job]=e});var c=e.tableData,u=e.arrOut,m=e.arrIn,d={"内部":{},"外部":{}};for(var _ in c)c[_].forEach(function(e){"不合格"===a[e.examine_result]&&(e.accountability.in.forEach(function(e){e&&(d["内部"][m[e].text]="")}),e.accountability.out.forEach(function(e){e&&(d["外部"][u[e].text]="")}))});var p=0;[M()(d["内部"]),M()(d["外部"])].forEach(function(e,a){e.forEach(function(e,i,c){var u=0===i?c.length:0;if(0===a){var m=0===i?s:0;if(o["内部"][e]){var d=T()({},o["内部"][e],{index:p,count:u,typeNum:m});t.push(d)}else if(r[e]){var _=T()({},r[e],{index:p,count:u,typeNum:m});t.push(_)}else{var v={index:p,count:u,type:"内部",typeNum:m,job:e,jobNum:0,list:[]};if(console.log(11111,n,e),n[e])for(var f in n[e])v.list.push(n[e][f]);t.push(v)}}else if(1===a){var h=0===i?l:0;if(o["外部"][e]){var b=T()({},o["外部"][e],{index:p,count:u,typeNum:h});t.push(b)}else if(r[e]){var x=T()({},r[e],{index:p,count:u,typeNum:h});t.push(x)}else{var y={index:p,count:u,type:"外部",typeNum:h,job:e,jobNum:0,list:[]};t.push(y)}}p++})}),e.formData=t},returnExamineGoods:function(e){var t=e.fileList,a=void 0===t?[]:t;return a.map(function(e){e.name=e.file_name,e.url=window.location.origin+"/nova"+e.file_path}),e.fileList=a,e},returnFormData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],a=t.inside_ratio,i=t.outside_ratio,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=[],s=[],l={};for(var r in n.forEach(function(e,t){var a=e.post_name,i={index:t,job:a,jobNum:0,list:{},type:"内部"};e.empList.forEach(function(e){var t=e.employee_id,a=e.examine_emp_id,n=void 0===a?"":a,o=e.employeename,s=e.num,l=void 0===s?0:s;i.list[o]={emp_id:t,examine_emp_id:n,name:o,num:l}}),l[a]=i}),e.forEach(function(e,t){var a=e.examineBusinessEmpList,i=void 0===a?[]:a,n=R()(e,["examineBusinessEmpList"]),o=n.post_name,s=n.ratio,r=n.out_in,c=T()({},n,{index:t,job:o,jobNum:s,type:{1:"内部",2:"外部"}[r]}),u={};i.forEach(function(e){var t=e.emp_id,a=e.examine_emp_id,i=void 0===a?"":a,n=e.emp_name,o=e.ratio;u[n]={emp_id:t,examine_emp_id:i,name:n,num:o}}),l[o]=T()({},l[o],c),l[o].list=T()({},l[o].list,u)}),l){var c=l[r];"内部"===c.type?o.push(c):"外部"===c.type&&s.push(c)}return o.length&&(o[0].count=o.length,o[0].typeNum=null!==a?a:0),s.length&&(s[0].count=s.length,s[0].typeNum=null!==i?i:0),o.concat(s)},returnTableObj:function(){var e={},t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(a,i){var n=a.store_name,o=a.custom_store_id;e[i+"."+n]||(e[i+"."+n]=[]);var s=a.examineGoodsDetailDutyList,l=R()(a,["examineGoodsDetailDutyList"]);if(0===s.length){var r=a.examine_detail_id,c=T()({},a,{accountability:{out:[],in:[]},file:{},index:i},{detail_explain:"",examine_detail_duty_id:"",examine_goods_id:"",in_post_id:"",out_code:"",ratio:0,reason_desc:"",reason_type:""},{examine_detail_id:r});c.fileList=c.fileList||[],c.fileList.map(function(e){e.name=e.file_name,e.url="/api"+e.file_path}),e[i+"."+n]=[c]}else s.length>0&&s.forEach(function(t){var a=T()({},l,{accountability:{out:[],in:[]},file:{},index:i},t);a.accountability.in=null===t.in_post_id?[]:t.in_post_id.split(","),a.accountability.out=null===t.out_code?[]:t.out_code.split(","),a.fileList=a.fileList||[],a.fileList.map(function(e){e.name=e.file_name,e.url="/api"+e.file_path}),e[i+"."+n].push(a)});t[n]=o}),{tableData:e,storehouse:t}},peopleList:function(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var a={};t.empList.forEach(function(e){var t=e.employee_id,i=e.examine_emp_id,n=void 0===i?"":i,o=e.employeename,s=e.num,l=void 0===s?0:s;a[e.employeename]={emp_id:t,examine_emp_id:n,name:o,num:l}}),e[t.post_name]=a}),e},returnArrOut:function(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var a=t.dcode,i=t.dcvalue;e[a]={label:a,text:i}}),e},returnArrIn:function(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var a=t.business_post_id,i=t.post_name;e[a]=T()({},t,{label:a,text:i})}),e},returnCate:function(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var a=t.name,i=t.qualify_id,n=[];t.detailList.forEach(function(e){var t=e.name,a=e.qualify_detail_id;n.push({label:t,value:a})}),e[i]={label:a,value:i,arr:n}}),e},returnYhclfs:function(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var a=t.dcode,i=t.dcvalue;e[a]={label:a,text:i}}),e},submitExamine_goods_detail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],a={};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach(function(e){a[e]=!0});var i=[],n={},o=[],s=1,l=function(i){var l="";e[i].forEach(function(e,i){if(e.isLocal&&"0"===e.is_delete);else{var r={},c=!0,u=e.examine_detail_duty_id,m=e.examine_detail_id,d=e.is_delete,_=e.remark,p=e.custom_store_id,v=e.store_name,f=e.examine_time,h=e.examine_name,b=e.examine_result,x=e.dispatch_order_id;0===i&&(l=null===f?"":f);var y={examine_detail_id:m,is_delete:d,remark:_,custom_store_id:p,store_name:v,examine_time:l,examine_name:h,examine_result:b,dispatch_order_id:void 0===x?[]:x};if("1"===d){if(null===b||b.length)if("1"===b)y.handle_mode="",r={examine_detail_duty_id:u,reason_type:"",reason_desc:"",ratio:"",out_code:"",in_post_id:"",detail_explain:""},v&&f&&h||(c=!1);else{var C=e.reason_type,w=e.reason_desc,g=e.ratio,k=e.detail_explain,T=e.accountability,L=T.in,D=T.out,j=e.handle_mode;y.handle_mode=j;var N=L.join(","),$=D.join(",");r={examine_detail_duty_id:u,reason_type:C,reason_desc:w,ratio:g,out_code:$,in_post_id:N,detail_explain:k},v&&f&&h&&C&&w&&g&&($||N)&&j||(c=!1)}else c=!1;var E=e.fileList,S=void 0===E?[]:E,F=e.examine_detail_id,G=t[F]||{},I=M()(G).length,O=S.length;S.forEach(function(e){a[e.acce_id]&&(O-=1)}),O+I<1&&(c=!1)}y.examineGoodsDetailDutyList=M()(r).length?[r]:[],n[m]?n[m].examineGoodsDetailDutyList.push(r):n[m]=y,c||o.push("第"+s+"条"),s++}})};for(var r in e)l(r);for(var r in n)i.push(n[r]);return{arr_detail:i,error_detail:o}},submitExamine_business_post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),a={"内部":"1","外部":"2"},i=[],n=0,o=0,s={};for(var l in t)t[l].empList&&t[l].empList.length&&t[l].empList.forEach(function(e){s[e.post_name]=e});return e.map(function(e){e.is_delete="1";var t=e.is_delete,l=e.job,r=e.jobNum,c=e.type,u=e.typeNum;"内部"===c&&(n=u>0?u:n),"外部"===c&&(o=u>0?u:o);var m={is_delete:t,post_name:l,ratio:r,out_in:a[c],examine_business_emp:[]};for(var d in e.list){var _=e.list[d],p=_.name,v=_.num,f=s[l]||{},h=f.business_post_id,b=void 0===h?"":h,x=f.employee_id;m.business_post_id=b,m.examine_business_emp.push({emp_id:x,emp_name:p,ratio:v})}i.push(m)}),{examine_business_post:i,inside_ratio:n,outside_ratio:o}},provingAccountability:function(e){var t=e.total,a=t.job,i=t.peoples,n=t.type,o=!0;for(var s in o=100===n&&o,a)o=100===a[s]&&o;for(var l in i)o=100===i[l]&&o;return o?"":"责任划分"}},B=z;i.default.use(c.a);var q=new c.a.Store({modules:{},state:{pageType:"",storehouse:{},examineGoods:{},examineBusinessPostList:{},customMap:{},tableData:{},peopleList:{},arrResultType:{},arrOut:{},arrIn:{},arrHandlingType:{},file:{},del_files:[],formData:[],time:"",modify_reason:"",modify_content:"",arrResult:{0:"不合格",1:"合格"}},getters:{tableList:function(e){return B.tableList(e)},summary:function(e){return B.summary(e)},accountability:function(e){return B.accountability(e)}},mutations:{changeTime:function(e){B.changeTime(e)},changeCheckbox:function(e){B.changeCheckbox(e)},saveData:function(e,t){var a=t.name,i=t.obj;e[a]=i},assignData:function(e,t){var a=t.name,i=t.obj,n=e[a]||{};e[a]=T()({},n,i)},deleteData:function(e,t){var a=t.name,i=t.key,n=t.type,o=void 0!==n&&n,s=e[a]||{};o?delete s[i]:(s[i].length=1,s[i][0].is_delete="0"),e[a]=T()({},s)},pushData:function(e,t){var a=t.name,i=t.key,n=t.val;e[a][i].push(n)},spliceData:function(e,t){var a=t.name,i=t.key,n=t.index;e[a][i].splice(n,1)}},actions:{A_showAddView:function(e,t){var a=e.state,i=e.commit,n=t.item_id;I({name:"页面数据",obj:{item_id:n},suc:function(e){console.log("返回的数据 ----- ",e);var t=e.examineGoods,n=e.customMap,o=e.examineGoodsDetailList,s=e.wbzrgs,l=e.businessPostList,r=e.examineNoQualifyList,c=e.yhclfs,u=e.examineBusinessPostList,m=B.returnTableObj(o),d=m.tableData,_=m.storehouse,p=B.returnFormData(u,t,l);a.examineGoods=B.returnExamineGoods(t),a.examineBusinessPostList=u,a.customMap=n,a.formData=p,a.tableData=d,a.storehouse=_,a.peopleList=B.peopleList(l),a.arrOut=B.returnArrOut(s),a.arrIn=B.returnArrIn(l),a.arrResultType=B.returnCate(r),a.arrHandlingType=B.returnYhclfs(c),i("changeTime"),i("changeCheckbox")}})},A_addExamineGoods:function(e,t){var a=e.state,i=e.getters,n=t.submitType,o=a.examineGoods,s=o.examine_goods_id,l=o.item_id,r=o.custom_id,c=o.final_examine_result,u={examine_goods_id:s,item_id:l,custom_id:r,final_examine_result:c,state:n,final_explain:o.final_explain,examine_time:o.examine_time,deliver_type:o.deliver_type},m=a.file,d=a.del_files;u.file=m,u.del_files=d;var _=a.tableData,p=B.submitExamine_goods_detail(_,m,d),v=p.arr_detail,f=p.error_detail;u.examine_goods_detail=g()(v);var h=a.formData,b=a.examineBusinessPostList,x=a.arrIn,y=B.submitExamine_business_post(h,b,x),C=y.examine_business_post,w=y.inside_ratio,k=y.outside_ratio;u.examine_business_post=g()(C),u.inside_ratio=w,u.outside_ratio=k;var T=a.pageType,L=a.modify_reason,D=a.modify_content;"modify"===T&&(u.modify_reason=L,u.modify_content=D);var j=[];if(1===n){null!==c&&c.length||j.push("<p>综合验货结果</p>");var N=i.accountability,E=B.provingAccountability(N);E&&j.push("<p>"+E+"</p>"),f.length&&j.push("验货明细："+f.join("、")),"modify"===T&&(""===L&&j.push("<p>变更原因</p>"),""===D&&j.push("<p>变更内容</p>"))}if(1===n&&j.length)$.MessageBox.alert(j.join(""),"请完善信息后再提交",{dangerouslyUseHTMLString:!0});else{var S=$.Loading.service({});I({name:"modify"===T?"变更":"保存",obj:u,suc:function(e){S.close(),dg.close()}})}}}}),H=(a("tvR6"),a("hKoQ"));a.n(H).a.polyfill(),i.default.use(E.a),new i.default({el:"#app",store:q,router:C,components:{App:o},template:"<App/>"})},QMsj:function(e,t){},Reu2:function(e,t){},T00w:function(e,t){},XGC8:function(e,t){},bJYQ:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.da7f507222683cd244d8.js.map